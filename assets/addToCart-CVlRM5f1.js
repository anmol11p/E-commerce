import{a as C,T as P,u as D,g as F}from"./getCartProductFromLs-DZ0_6J83.js";import{g as f}from"./product-CWXsdmGD.js";let u=document.querySelector(".cartTotalPrice").textContent;u=parseInt(u);u=0;let m=document.querySelector(".cartFinalTotal").textContent;m=parseInt(m);m=0;let y=document.querySelector(".tax").textContent;y=parseInt(y);y=50;const g=()=>{u=C().reduce((e,a)=>e+a.price,0),u=Number(u).toFixed(3),m=Number(u)+y,document.querySelector(".cartTotalPrice").textContent=`₹${u}`,document.querySelector(".cartFinalTotal").textContent=`₹${m}`};let q=[];const T=async()=>{try{q=[...await f()]}catch(r){console.error("Error fetching product data:",r)}},b=(r,e)=>{const a=document.getElementById(`cart${e}`);let t=a.querySelector(".ProductquantityCart").textContent;t=parseInt(t);let o=a.querySelector(".productPriceCart").textContent;o=parseFloat(o);let s=0;const i=r.target.className==="incrementInCart",l=r.target.className==="decrementInCart";if(q.find(c=>{c.id===e&&(s=c.total_stock_available)}),i&&t<s||l&&t>1){t=i?t+1:t-1,q.find(n=>{n.id===e&&(o=(n.product_price*t).toFixed(3),s=n.total_stock_available)});//! update in local storage
const c=C(),d=c.find(n=>n.id===e);d.quantity=t,d.price=Number(o);const p=c.filter(n=>n.id!==e);p.push(d),localStorage.setItem("cartProductLs",JSON.stringify(p)),a.querySelector(".ProductquantityCart").textContent=t,a.querySelector(".productPriceCart").textContent=o}g()};T();const L=r=>{const a=C().filter(o=>o.id!==r);localStorage.setItem("cartProductLs",JSON.stringify(a));const t=document.querySelector(`#cart${r}`);t&&(t.remove(),P("deleteItems",r)),D(a),g()},N=document.querySelector(".cartContainerTemplate"),_=document.querySelector(".cartContainer"),k=r=>{const e=document.importNode(N.content,!0),{id:a,category:t,image:o,product_name:s,quantity:i,price:l}=r;e.querySelector(".product-info").setAttribute("id",`cart${a}`),e.querySelector(".productCategoryCart").textContent=t,e.querySelector(".productImageCart").src=o,e.querySelector(".productNameCart").textContent=s,e.querySelector(".productPriceCart").textContent=l,e.querySelector(".ProductquantityCart").textContent=i,e.querySelector(".removeButton").addEventListener("click",()=>{L(a)}),e.querySelector(".quantity-selector-cart").addEventListener("click",c=>{b(c,a)}),_.append(e)};let I=[];const v=async()=>{try{I=[...await f()],$()}catch(r){console.error("Error fetching product data:",r)}},$=()=>{let r=C(),e=r.map(t=>t.id);I.filter(t=>e.includes(t.id)).map(t=>{const o=r.find(x=>x.id===t.id),{quantity:s,price:i}=o,{id:l,category:c,image:d,product_name:p}=t;k({id:l,category:c,image:d,product_name:p,quantity:s,price:i})}),g()};let S=localStorage.getItem("token");S&&F(S);const h=async()=>{await v()};h();
